<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Profile - Job Portal</title>
  <link rel="icon" type="image/png" href="Images/icon.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body {
      background: url("Images/bg2.jpg") no-repeat center center fixed;
      background-size: cover;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 2rem;
    }

    .background-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      z-index: 0;
    }

    .content {
      position: relative;
      z-index: 1;
    }

    .profile-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .profile-header {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #4B3621;
      padding-bottom: 20px;
    }

    .profile-avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 4px solid #4B3621;
      margin: 0 auto 15px;
    }

    .btn-coffee {
      background: linear-gradient(to right, #4B3621, #A9746E);
      color: #fff;
      border: none;
      font-weight: 500;
    }

    .btn-coffee:hover {
      background: linear-gradient(to right, #3b281b, #86534e);
      color: #fff;
    }

    .skill-tag {
      display: inline-block;
      background: #4B3621;
      color: white;
      padding: 5px 10px;
      border-radius: 20px;
      margin: 5px;
      font-size: 0.9rem;
    }

    .nav-tabs .nav-link.active {
      background: linear-gradient(to right, #4B3621, #A9746E);
      color: white;
      border: none;
    }

    .nav-tabs .nav-link {
      color: #4B3621;
    }
  </style>
</head>
<body>

  <div class="background-overlay"></div>
  <div class="content">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-10">
          <div class="profile-card">
            <div class="profile-header">
              <img id="profileAvatar" src="" alt="Profile Avatar" class="profile-avatar">
              <h2 id="profileName" class="text-dark">User Profile</h2>
              <p id="profileRole" class="text-muted"></p>
            </div>

            <ul class="nav nav-tabs mb-4" id="profileTabs">
              <li class="nav-item">
                <a class="nav-link active" id="personal-tab" data-bs-toggle="tab" href="#personal">Personal Information</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="professional-tab" data-bs-toggle="tab" href="#professional">Professional Details</a>
              </li>
            </ul>

            <div class="tab-content">
              <!-- Personal Information Tab -->
              <div class="tab-pane fade show active" id="personal">
                <div id="jobSeekerProfile">
                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label class="form-label">Full Name</label>
                      <input type="text" class="form-control" id="profileFullName">
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Email</label>
                      <input type="email" class="form-control" id="profileEmail" readonly>
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label class="form-label">Phone Number</label>
                      <input type="tel" class="form-control" id="profilePhone">
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Location</label>
                      <input type="text" class="form-control" id="profileLocation">
                    </div>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Address</label>
                    <textarea class="form-control" id="profileAddress" rows="3"></textarea>
                  </div>
                </div>

                <div id="companyProfile" style="display: none;">
                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label class="form-label">Company Name</label>
                      <input type="text" class="form-control" id="companyName">
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Email</label>
                      <input type="email" class="form-control" id="companyEmail" readonly>
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-md-6">
                      <label class="form-label">Industry</label>
                      <input type="text" class="form-control" id="companyIndustry">
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Company Size</label>
                      <input type="text" class="form-control" id="companySize">
                    </div>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Company Description</label>
                    <textarea class="form-control" id="companyDescription" rows="4"></textarea>
                  </div>
                </div>
              </div>

              <!-- Professional Details Tab -->
              <div class="tab-pane fade" id="professional">
                <div id="jobSeekerProfessional">
                  <div class="mb-3">
                    <label class="form-label">Skills</label>
                    <input type="text" class="form-control" id="profileSkills" placeholder="Add skills separated by commas">
                    <div id="skillsDisplay" class="mt-2"></div>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Experience</label>
                    <textarea class="form-control" id="profileExperience" rows="3" placeholder="Describe your work experience"></textarea>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Education</label>
                    <textarea class="form-control" id="profileEducation" rows="3" placeholder="Your educational background"></textarea>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Preferred Job Types</label>
                    <input type="text" class="form-control" id="profileJobTypes" placeholder="Add preferred job types separated by commas">
                    <div id="jobTypesDisplay" class="mt-2"></div>
                  </div>
                </div>

                <div id="companyProfessional" style="display: none;">
                  <div class="mb-3">
                    <label class="form-label">Website</label>
                    <input type="url" class="form-control" id="companyWebsite" placeholder="Company website URL">
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Contact Person</label>
                    <input type="text" class="form-control" id="contactPerson" placeholder="HR or contact person name">
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Company Values</label>
                    <textarea class="form-control" id="companyValues" rows="3" placeholder="Company culture and values"></textarea>
                  </div>
                </div>
              </div>
            </div>

            <div class="d-flex justify-content-between mt-4">
              <a href="#" id="backButton" class="btn btn-coffee">Back to Dashboard</a>
              <button id="saveProfile" class="btn btn-coffee">Save Profile</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      
      if (!currentUser) {
        alert('Please login to view your profile');
        window.location.href = 'login.html';
        return;
      }
      
      // Set back button URL based on user role
      const backButton = document.getElementById('backButton');
      if (currentUser.role === 'jobseeker') {
        backButton.href = 'search-job.html';
      } else if (currentUser.role === 'company') {
        backButton.href = 'post-job.html';
      } else {
        backButton.href = 'login.html';
      }
      
      // Populate profile data
      document.getElementById('profileAvatar').src = currentUser.avatar || 'Images/default-avatar.png';
      document.getElementById('profileName').textContent = currentUser.username;
      document.getElementById('profileRole').textContent = currentUser.role === 'jobseeker' ? 'Job Seeker' : 
                                                         currentUser.role === 'company' ? 'Employer' : 'Administrator';
      
      if (currentUser.role === 'jobseeker') {
        document.getElementById('jobSeekerProfile').style.display = 'block';
        document.getElementById('companyProfile').style.display = 'none';
        document.getElementById('jobSeekerProfessional').style.display = 'block';
        document.getElementById('companyProfessional').style.display = 'none';
        
        // Populate job seeker fields
        document.getElementById('profileFullName').value = currentUser.profile?.fullName || '';
        document.getElementById('profileEmail').value = currentUser.email || '';
        document.getElementById('profilePhone').value = currentUser.profile?.phone || '';
        document.getElementById('profileLocation').value = currentUser.profile?.location || '';
        document.getElementById('profileAddress').value = currentUser.profile?.address || '';
        
        // Skills
        const skills = currentUser.profile?.skills || [];
        document.getElementById('profileSkills').value = skills.join(', ');
        displayTags('skillsDisplay', skills, 'skill-tag');
        
        document.getElementById('profileExperience').value = currentUser.profile?.experience || '';
        document.getElementById('profileEducation').value = currentUser.profile?.education || '';
        
        // Job types
        const jobTypes = currentUser.profile?.preferredJobTypes || [];
        document.getElementById('profileJobTypes').value = jobTypes.join(', ');
        displayTags('jobTypesDisplay', jobTypes, 'skill-tag');
        
      } else if (currentUser.role === 'company') {
        document.getElementById('jobSeekerProfile').style.display = 'none';
        document.getElementById('companyProfile').style.display = 'block';
        document.getElementById('jobSeekerProfessional').style.display = 'none';
        document.getElementById('companyProfessional').style.display = 'block';
        
        // Populate company fields
        document.getElementById('companyName').value = currentUser.profile?.companyName || '';
        document.getElementById('companyEmail').value = currentUser.email || '';
        document.getElementById('companyIndustry').value = currentUser.profile?.industry || '';
        document.getElementById('companySize').value = currentUser.profile?.companySize || '';
        document.getElementById('companyDescription').value = currentUser.profile?.description || '';
        document.getElementById('companyWebsite').value = currentUser.profile?.website || '';
        document.getElementById('contactPerson').value = currentUser.profile?.contactPerson || '';
        document.getElementById('companyValues').value = currentUser.profile?.values || '';
      }
      
      // Save profile
      document.getElementById('saveProfile').addEventListener('click', function() {
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.id === currentUser.id);
        
        if (userIndex !== -1) {
          if (currentUser.role === 'jobseeker') {
            users[userIndex].profile = {
              fullName: document.getElementById('profileFullName').value,
              phone: document.getElementById('profilePhone').value,
              location: document.getElementById('profileLocation').value,
              address: document.getElementById('profileAddress').value,
              skills: document.getElementById('profileSkills').value.split(',').map(s => s.trim()),
              experience: document.getElementById('profileExperience').value,
              education: document.getElementById('profileEducation').value,
              preferredJobTypes: document.getElementById('profileJobTypes').value.split(',').map(j => j.trim())
            };
          } else if (currentUser.role === 'company') {
            users[userIndex].profile = {
              companyName: document.getElementById('companyName').value,
              industry: document.getElementById('companyIndustry').value,
              companySize: document.getElementById('companySize').value,
              description: document.getElementById('companyDescription').value,
              website: document.getElementById('companyWebsite').value,
              contactPerson: document.getElementById('contactPerson').value,
              values: document.getElementById('companyValues').value
            };
          }
          
          localStorage.setItem('users', JSON.stringify(users));
          localStorage.setItem('currentUser', JSON.stringify(users[userIndex]));
          alert('Profile updated successfully!');
        }
      });
      
      // Function to display tags
      function displayTags(containerId, tags, tagClass) {
        const container = document.getElementById(containerId);
        container.innerHTML = '';
        
        tags.forEach(tag => {
          if (tag.trim()) {
            const tagElement = document.createElement('span');
            tagElement.className = tagClass;
            tagElement.textContent = tag;
            container.appendChild(tagElement);
          }
        });
      }
    });
  </script>
</body>
</html>